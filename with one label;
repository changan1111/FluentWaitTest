Copy code
// Fetch the page load times from the SQL Server database for the selected page
async function getPageLoadTimes(pageName) {
  try {
    await sql.connect(dbConfig);

    let query = 'SELECT * FROM Performance';
    if (pageName) {
      query += ` WHERE PageName = '${pageName}'`;
    }

    const result = await sql.query(query);

    return result.recordset;
  } catch (error) {
    console.error('Error fetching page load times:', error);
    throw error;
  }
}

// Calculate the average load time for a specific page
function calculateAverageLoadTime(pageLoadTimes) {
  const loadTimes = pageLoadTimes.map((entry) => entry.LoadTime);

  const minLoadTime = Math.min(...loadTimes);
  const maxLoadTime = Math.max(...loadTimes);
  const averageLoadTime = loadTimes.reduce((total, time) => total + time, 0) / loadTimes.length;

  return { minLoadTime, maxLoadTime, averageLoadTime };
}
